define("discourse/plugins/discourse-checklist/discourse/initializers/checklist",["exports","discourse/lib/plugin-api","discourse/lib/ajax","discourse-common/lib/icon-library","I18n"],(function(e,n,c,t,i){"use strict";function s(e,n){if(n){var s=e.find(".chcklst-box"),a=n.widget,r=n.getModel();r.can_edit&&(s.each((function(e,n){$(n).click((function(n){var s=$(n.currentTarget);if(!s.hasClass("permanent")){var o=s.hasClass("checked")?"[ ]":"[x]";s.after((0,t.iconHTML)("spinner",{class:"fa-spin"})).hide(),(0,c.ajax)("/posts/".concat(r.id),{type:"GET",cache:!1}).then((function(n){var c=[];[/`[^`\n]*\n?[^`\n]*`/gm,/^```[^]*?^```/gm,/\[code\][^]*?\[\/code\]/gm,/_(?=\S).*?\S_/gm,/~~(?=\S).*?\S~~/gm].forEach((function(e){for(var t;null!=(t=e.exec(n.raw));)c.push([t.index,t.index+t[0].length])})),[/([^\[\n]|^)\*\S.+?\S\*(?=[^\]\n]|$)/gm].forEach((function(e){for(var t;null!=(t=e.exec(n.raw));)c.push([t.index+1,t.index+t[0].length])}));var t=-1,s=!1,u=n.raw.replace(/\[(\s|\_|\-|\x|\\?\*)?\]/gi,(function(n,i,a){return s?n:(t+=c.every((function(e){return e[0]>=a+n.length||a>e[1]})))===e?(s=!0,o):n})),l=r.save({raw:u,edit_reason:i.default.t("checklist.edit_reason")});l&&l.then&&l.then((function(){a.attrs.isSaving=!1,a.scheduleRerender()}))}))}}))})),s.css({cursor:"pointer"}))}}Object.defineProperty(e,"__esModule",{value:!0}),e.checklistSyntax=s,e.default=void 0;var a={name:"checklist",initialize:function(){(0,n.withPluginApi)("0.1",(function(e){return function(e){e.container.lookup("site-settings:main").checklist_enabled&&e.decorateCooked(s,{id:"checklist"})}(e)}))}};e.default=a})),define("discourse/plugins/discourse-checklist/lib/discourse-markdown/checklist",["exports"],(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setup=function(e){e.registerOptions((function(e,n){e.features.checklist=!!n.checklist_enabled})),e.allowList(["span.chcklst-stroked","span.chcklst-box fa fa-square-o fa-fw","span.chcklst-box checked fa fa-check-square-o fa-fw","span.chcklst-box checked permanent fa fa-check-square fa-fw"]),e.registerPlugin((function(e){return e.core.ruler.push("checklist",i)}))};var n=/\[(\s?|x|X)\]/g;function c(e,n,c,t){var i=function(e){switch(e){case"x":return"checked fa fa-check-square-o fa-fw";case"X":return"checked permanent fa fa-check-square fa-fw";default:return"fa fa-square-o fa-fw"}}(c[1]),s=new t.Token("check_open","span",1);s.attrs=[["class","chcklst-box ".concat(i)]],e.push(s);var a=new t.Token("check_close","span",-1);e.push(a)}function t(e,t){for(var i,s=null,a=0;i=n.exec(e);){if(i.index>a){s=s||[];var r=new t.Token("text","",0);r.content=e.slice(a,i.index),s.push(r)}a=i.index+i[0].length,c(s=s||[],0,i,t)}if(s&&a<e.length){var o=new t.Token("text","",0);o.content=e.slice(a),s.push(o)}return s}function i(e){var n,c,i,s,a,r=e.tokens,o=0;for(c=0,i=r.length;c<i;c++)if("inline"===r[c].type)for(n=(s=r[c].children).length-1;n>=0;n--)if(o+=(a=s[n]).nesting,"text"===a.type&&0===o){var u=t(a.content,e);u&&(r[c].children=s=e.md.utils.arrayReplaceAt(s,n,u))}}}));
//# sourceMappingURL=discourse-checklist-1e07a6f8feed538735d6b92a0ab960ace8430ada4cec9ba1f112d3fdab3b9844.js.map